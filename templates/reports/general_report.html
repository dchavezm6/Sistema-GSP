{% extends 'base.html' %}

{% block title %}Reporte General - {{ block.super }}{% endblock %}

{% block content %}
<div class="container my-4">
    <div class="row mb-4">
        <div class="col-12">
            <h2 class="fw-bold text-dark">
                <i class="bi bi-file-earmark-text"></i> Reporte General
            </h2>
            <p class="text-muted">Período: {{ date_from|date:"d/m/Y" }} - {{ date_to|date:"d/m/Y" }}</p>
        </div>
    </div>

    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card bg-primary text-white">
                <div class="card-body text-center">
                    <h3>{{ stats.total_requests }}</h3>
                    <p class="mb-0">Total Solicitudes</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-warning text-white">
                <div class="card-body text-center">
                    <h3>{{ stats.pending }}</h3>
                    <p class="mb-0">Pendientes</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-info text-white">
                <div class="card-body text-center">
                    <h3>{{ stats.in_progress }}</h3>
                    <p class="mb-0">En Progreso</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-success text-white">
                <div class="card-body text-center">
                    <h3>{{ stats.completed }}</h3>
                    <p class="mb-0">Completadas</p>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-6">
            <div class="card">
                <div class="card-body">
                    <h5>Tasa de Completación</h5>
                    <h2 class="text-success">{{ stats.completion_rate|floatformat:1 }}%</h2>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card">
                <div class="card-body">
                    <h5>Tiempo Promedio de Resolución</h5>
                    <h2 class="text-primary">{{ stats.average_completion_days|floatformat:1 }} días</h2>
                </div>
            </div>
        </div>
    </div>

    {% if response_times %}
    <div class="row mt-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">Análisis de Tiempos de Respuesta</h5>
                </div>
                <div class="card-body">
                    <p><strong>Promedio:</strong> {{ response_times.average_days|floatformat:1 }} días</p>
                    <p><strong>Mínimo:</strong> {{ response_times.min_days }} días</p>
                    <p><strong>Máximo:</strong> {{ response_times.max_days }} días</p>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <div class="row mt-3">
        <div class="col-12">
            <a href="{% url 'reports:dashboard' %}" class="btn btn-outline-secondary">
                <i class="bi bi-arrow-left"></i> Volver
            </a>
        </div>
    </div>
</div>
{% endblock %}